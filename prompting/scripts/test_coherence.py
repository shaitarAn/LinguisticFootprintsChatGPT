import spacy
import textdescriptives as td
nlp = spacy.load("en_core_web_lg")
nlp.add_pipe("textdescriptives/coherence")
text_machine = "The patient 's medical history reveals no significant past medical conditions or surgeries . She does not have any known allergies , and her family history is unremarkable . The patient denies any recent travel or exposure to sick contacts . Upon further questioning , the patient reports fatigue , night sweats , and occasional shortness of breath . She also mentions a persistent cough that has been present for the past two weeks . She denies any chest pain or hemoptysis . The patient has not noticed any changes in her bowel movements or urinary habits . Physical examination reveals a pale and emaciated woman . She appears weak and fatigued . Vital signs are stable except for an elevated temperature of 38 Â° C . There are no signs of respiratory distress , and lung auscultation reveals decreased breath sounds in the right upper lobe . Heart sounds are normal , and there are no murmurs or gallops appreciated . Abdominal examination is unremarkable with no tenderness or palpable masses . There are no skin rashes or lesions noted . Laboratory findings show a microcytic anemia with a hemoglobin level of 8.1g / dl . Mean globular volume ( MGV ) is 78.5 fl , indicating microcytosis . Thrombocytopenia is present with a platelet count of 9000 G / l. The patient also has leukopenia with a leukocyte count of 1580 G / l. Further differential analysis reveals neutropenia with a neutrophil count of 850 G / l and lymphopenia with a lymphocyte count of 500 G / l. Given the patient 's clinical presentation and laboratory findings , the differential diagnoses include infectious etiologies such as tuberculosis or disseminated fungal infection , autoimmune conditions like systemic lupus erythematosus , hematological malignancies such as lymphoma or leukemia , and chronic inflammatory diseases like sarcoidosis . Further investigations are warranted to reach a definitive diagnosis . These may include imaging studies such as chest X - ray or computed tomography ( CT ) scan , sputum analysis for acid - fast bacilli ( AFB ) and fungal cultures , serological tests for autoimmune markers , bone marrow biopsy , and pleural or lymph node biopsies if needed . The patient is admitted to the hospital for further evaluation and management . She is started on broad - spectrum antibiotics to cover potential infectious causes while awaiting test results . Supportive measures , including blood transfusions and close monitoring of vital signs , are initiated . The clinical case description highlights the significant weight loss , asthenia , fever , and altered general condition in a young woman . The presence of microcytic anemia , thrombocytopenia , and leukopenia further raise concerns for a serious underlying condition . The differential diagnoses are broad , and further investigations are necessary to establish a definitive diagnosis and guide appropriate treatment . The patient 's symptoms of fatigue , night sweats , and occasional shortness of breath , along with the presence of a cough and decreased breath sounds in the right upper lobe on physical examination , suggest a possible respiratory etiology . Infectious causes such as tuberculosis or disseminated fungal infection should be considered , especially given the patient 's fever and the"

text_human = "A 21 year old female patient with the diagnosis of SWS suffering from headaches admitted to our clinic. She had a 2 year history of frequent non-pulsating headaches. Her headache was relieving with non-steroidal anti-inflammatory drugs and was not worsening with physical activity. There was no nausea or aura like symptoms accompanying the headache. Headaches were lasting for hours. The pain was bilateral, generalized and pressing in quality. The family history for headache was negative. She had a history of seizures occurring in the fifteenth day of life described as attacks of tonic clonic contractions and that's when she was diagnosed with SWS. At the age of 6 she had a history of callosotomy to control her seizures. At the age of 18 during a laser treatment done in order to get rid of her port wine birthmark she had her first seizure since callosotomy. After that she was prescribed carbamazepine 400 mg at daily dose and never had a seizure since then. According to the story taken from her parents even though she had a normal development at infancy she barely graduated from elementary school and she's hardly literate. There was nothing significant on her family history except for her elder sister's port wine stain on her face. The elder sister had no feature of SWS and no researches were done regarding her stain. She was inscribed daily doses of ketiapin 25 mg for anxiety disorder and venlafaxine 75 mg for both anxiety disorder and the chronic headaches. She was also inscribed NSAID drugs. After the first week of this treatment her headaches were slightly decreased by heaviness but the frequency was the same. At her physical examination a facial nevus -occurred due to choroid angioma-on the right forehead, right eyelid, nasal wing and the cheek was observed. Intra oral examination showed a right sided overgrowth of gingiva. Gingival overgrowth was bright red in color and showed blanching on applying pressure suggesting angiomatous enlargement. On her extremities a mild asymmetry was visible. Her left arm and leg was slightly smaller in portions and showed hemiparesis both in the upper and lower extremities of the same size. On her ophthalmological evaluation she was diagnosed with glaucoma of the right eye. On her psychiatric examination she showed signs of anxiety disorder. Her neurological examination was not remarkable except for her hemiparesis. Cranial CT scans showed diffuse atrophy in the right hemisphere and irregular double-contoured gyriform cortical calcifications in the right occipital area. Gadolinium enhanced brain MRI revealed multiple dilated pial venous vascular structures on right hemisphere also with the diffuse atrophy on the same side. Axial T1 weighted cranial MRI shows right calvarial thickness compared to the left and right hemisphere is asymmetrically smaller than the left. In addition to that, T2 weighted MRI shows extensive venous formations around corpus of right lateral ventricle and at Gallen vein localization and widespread vascular formations are seen at perivascular space, anterior to third ventricle at Willis polygon localization and at right temporooccipital area at quadrigeminal cistern localization. She was performed a proteus intelligence test in which she had 75 points and accepted as mildly mentally retarded. Proteus intelligence test in which she had 75 points and accepted as mildly mentally retarded."

doc = nlp(text_machine)

for token in doc:
    if token.is_oov:
        print(token.text, token.has_vector, token.vector_norm, token.is_oov)

# all attributes are stored as a dict in the ._.coherence attribute
doc._.coherence

# first and second order coherence values are also added as separate attributes
# note that the first/first two sentences do not have any values for first/second order
# coherence, respectively, as they require 1 or 2 sentences to average over
doc._.first_order_coherence_values
doc._.second_order_coherence_values

# extract to dataframe
td.extract_df(doc)

# print the doc with the coherence values
print(doc._.coherence)
